var P=(o,i,t)=>{if(!i.has(o))throw TypeError("Cannot "+t)};var a=(o,i,t)=>(P(o,i,"read from private field"),t?t.call(o):i.get(o)),A=(o,i,t)=>{if(i.has(o))throw TypeError("Cannot add the same private member more than once");i instanceof WeakSet?i.add(o):i.set(o,t)},l=(o,i,t,r)=>(P(o,i,"write to private field"),r?r.call(o,t):i.set(o,t),t);var m=(o,i,t)=>(P(o,i,"access private method"),t);(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const h of s.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&r(h)}).observe(document,{childList:!0,subtree:!0});function t(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerpolicy&&(s.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?s.credentials="include":e.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(e){if(e.ep)return;e.ep=!0;const s=t(e);fetch(e.href,s)}})();class O{constructor(i){const t=document.querySelector(".js_canvas"),{width:r,height:e}=t.getBoundingClientRect();this.width=t.width=r+(i-r%i),this.height=t.height=e+(i-e%i),this.ctx=t.getContext("2d")}}class R{constructor(i,t,r,e){this.ctx=i,this.ctxWidth=t,this.ctxHeight=r,this.width=e,this.height=e}}const M=""+new URL("../images/snake-sprite-f324a521.png",import.meta.url).href,n=42,y={HEAD:{x1:0,y1:0,x2:n,y2:n},CASUAL_TAIL:{x1:n*2,y1:n*2,x2:n,y2:n},LEFT_BOTTOM_CORNER_TAIL:{x1:n,y1:n,x2:n,y2:n},RIGHT_BOTTOM_CORNER_TAIL:{x1:n*2,y1:n,x2:n,y2:n},END_TAIL:{x1:n,y1:n*2,x2:n,y2:n}};var c,d,u,S,L,C;class H extends R{constructor(t,r,e,s){super(t,r,e,s);A(this,u);A(this,L);A(this,c,0);A(this,d,0);this.movementPower=s,this.bodyLength=2;let h=Math.round((r-this.width)*.5),g=Math.round((e-this.height)*.5);this.directionIsChangedForNextFrame=!1,this.positionX=h-h%s,this.positionY=g-g%s,this.bodyPositionList=[],this.snakeSprite=new Image,this.snakeSprite.src=M}draw(){m(this,u,S).call(this),m(this,L,C).call(this)}grow(){this.bodyLength++}degradate(){this.bodyLength=1}setDirection(t){if(!(!["ArrowLeft","KeyA","ArrowRight","KeyD","ArrowUp","KeyW","ArrowDown","KeyS"].includes(t)||this.directionIsChangedForNextFrame))switch(this.directionIsChangedForNextFrame=!0,t){case"ArrowLeft":case"KeyA":if(l(this,d,0),a(this,c)===this.movementPower)break;l(this,c,-this.movementPower);break;case"ArrowRight":case"KeyD":if(l(this,d,0),a(this,c)===-this.movementPower)break;l(this,c,this.movementPower);break;case"ArrowUp":case"KeyW":if(l(this,c,0),a(this,d)===this.movementPower)break;l(this,d,-this.movementPower);break;case"ArrowDown":case"KeyS":if(l(this,c,0),a(this,d)===-this.movementPower)break;l(this,d,this.movementPower);break}}}c=new WeakMap,d=new WeakMap,u=new WeakSet,S=function(){this.directionIsChangedForNextFrame=!1;const t=this.positionX+a(this,c),r=this.positionY+a(this,d);t>=this.ctxWidth?this.positionX=0:t<0?this.positionX=this.ctxWidth:this.positionX=t,r>=this.ctxHeight?this.positionY=0:r<0?this.positionY=this.ctxHeight:this.positionY=r},L=new WeakSet,C=function(){this.bodyPositionList.length>this.bodyLength&&(this.bodyPositionList=this.bodyPositionList.slice(-this.bodyLength)),this.bodyPositionList.push({x:this.positionX,y:this.positionY,xDirectionBackward:a(this,c)<0,xDirectionForward:a(this,c)>0,yDirectionBackward:a(this,d)<0,yDirectionForward:a(this,d)>0}),this.bodyPositionList.forEach((t,r)=>{let s=r===this.bodyPositionList.length-1?y.HEAD:y.CASUAL_TAIL;const h=this.bodyPositionList[r+1];h&&(t.yDirectionForward&&h.xDirectionBackward||t.xDirectionForward&&h.yDirectionForward||t.yDirectionBackward&&h.xDirectionForward||t.xDirectionBackward&&h.yDirectionBackward?s=y.RIGHT_BOTTOM_CORNER_TAIL:(t.xDirectionForward&&h.yDirectionBackward||t.yDirectionBackward&&h.xDirectionBackward||t.xDirectionBackward&&h.yDirectionForward||t.yDirectionForward&&h.xDirectionForward)&&(s=y.LEFT_BOTTOM_CORNER_TAIL));let g=t.xDirectionBackward?180:t.xDirectionForward?-180:t.yDirectionBackward?360:0;this.ctx.save(),this.ctx.translate(t.x,t.y),this.ctx.rotate(g*Math.PI/360),this.ctx.drawImage(this.snakeSprite,s.x1,s.y1,s.x2,s.y2,t.xDirectionForward||t.yDirectionBackward?0-n*.5:0,t.xDirectionBackward||t.yDirectionBackward?0-n*.5:0,this.width,this.height),this.ctx.restore()})};const b=(o,i)=>Math.random()*(i-o)+o;class V extends R{constructor(i,t,r,e,s,h){super(i,t,r,e),this.image=s,this.imageSize=h;let g=Math.round(b(this.width,t-this.width)),D=Math.round(b(this.height,r-this.height));this.positionX=g-g%e,this.positionY=D-D%e}draw(){this.ctx.drawImage(this.image,0,0,this.imageSize,this.imageSize,this.positionX,this.positionY,this.width,this.height)}}const K="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAsQAAALEBxi1JjQAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAPJSURBVEiJnZNLiFxFFIa/U/fRz3T3dObhkCGJ0byjiUSJuAgjkrhQcKMJEckiGwm4EIQsRFdZ6iIbQRBEEBECulQnLjLqQjIQ4isaQsg4k4cmxqFf0z333rp1XPQMauweOv7LqnP+7/ynKGEVvTxz4CmBMyJ8fufRynON0zP7AaYOz509PnPgA0VfwvOOv7t36r1+Hv5qAEGPASZO42eYvnQNZAjg8PSe2cRF230TIi49Avw/wKKtP+g0xanSarbGNVUAmvXGdi8wSAoiZuPqQ/bQ06cnquCfFcw28V3oZT3iulW3aAXA5H3NDAUkHStYSRW9CPbJqUPXFwYCABz8eOM+4/GZKlVUsS3Lhi2bAJi7fBW/6IMIIlJXODh1aHaml4/pBzhz5NdzqcgRVXCJozo6TJjNEGYzVEeHcYlDFRy80M+8b4JXL0xWIhu8qeqqC7fuPN+sNYrrNq3HDwIAbJJw4+o8ayqlVnVs9BMR/sz4yclTj0zXBkpwas90HcdtkKPVsZHi+OZ1RNKmmSzQTBaIpM345nVUx0aKoEcdmlT2TDYGTrCiY9/uf7th/3jN15hNoUfF65bXUmUuTokkpBQOv/X+vm9O3NOKVnRx9rH7ri92bkzmfRPcVZk4x6XFJV1byG2beOD7y/cM0CsPj6pnvlYbbdWkg8mWQJY3qoqLGuCFJLFtGcnuy+y8+HMvn74fTcV96Dr1ra5+DdShQQ5T3gBicPU5NF4EBH/NeDG2yVfAyMAJ7A/DL7rWnY/6we9WrQWZUumd8uONV+6+6/0PbHq0ixdMeQJveCsmN/T3VJkS3vAWTGU9iME3oHF8uJdV7xUVR34zYR4Ji0iQ65pWNkCmBKpdmAgS5JEgT8hNJJtvwO+DAcTPtyXIA6AugaSDhMV/pFA0aoIXIn4WvzwKSnvgBBo1q5Ip4KImrjYPmiJBHlNZfuTaPBo3QQymPAHqk8ZLhZ7D9jpMzpd/1Ki+q9ddL7U6IF4QDU0m2YESANEK35TGkaCALt7GLdW7p5kipjiO2g6ucRN1DvHE9jLqCTD56qca5vZKuAYJu8klvB/aC6AOU1gLCBIWkKCAb+cJ8qVzcOs/Xj1XpFd3jan4s0AOl6A2WgYtl6uiSRu8AGsdSdQhCPIPZXb88tNAgC5k9xsubp1Ma7+CS5GggBnaiIiQ1ubRqEHqDIkpElZGv8zuuHKwl09/gOLZ78rntVPf/e8OAVXiBNpL4GeCpaGRpCw7ie8JsKLkwsjrdql1wtq45GwqqmBTwRiThrn8F8Unms+u1v8XyhOV+PwMmBgAAAAASUVORK5CYII=",U="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAApgAAAKYB3X3/OAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAMxSURBVEiJnVVNaFRXFP7Ovff9TPoyMglCMopKVinUH0QR3BiHSKeBdiFiXRW0G7EL0UJVEEVBBQvFUlA3IriyLSpEk4wLRd256KK02GXF1CZ16sRMYsb35t17XMQ3zLw30ZeczX3nu/d83zn33cMhZsZSbKRyfGu9/vpHX9c2GGaSpGpCyKpgWVZCjDsq++TT7pNH1FLIh8vfFeeCV3dCE8oI06h70PCkUHnPWbG+0+m6BwBLEDgl3gSzN0MTSiIBWziwpAtbunBVB1zlQZB4I4W8kVrg1s6V3dLWu7+4PnHpzrFbD7z9gxkvtwa2zLQ9z8CJzZkD46kFysufV3unew/d3tNLxJjKLV+9kRjfAvgyxmEAfP/PRz0/RAC97ydXi8WubKlUAYDbe/KXQdgldfjJ0C8vJgHgyW+nVk33d+0k8DoG/mPmsa3ewUfNHAmByo4d+4IwPFPXugcACGAlxMzLTBXTzpz6eHbl7x2WFRCwDkAOgA+gREKcs0ZGHseTbBF4WShcmQvDfe2qqcsQf+cmsanaB0cpCKL4EUNEe63R0WvNoIg+yoXC2XbkgghZx4EHB662EBiDBa5VMPNVf2jos2QF27erf5lntTFOnDznulBC4L0mJSibBU9NAcAfdqm0PspCAECZ6HScHAA82/4wOQDR1wfR3w/K5wFgrV8sft7YAwAGtiWSIkJGpezDjg4AAOVy8yvRllYBY9YkYiwrHTkAzMzMr74/vzL3R1sKAAzQGY9p80oWNDM+DhGGMJOTEdTT4AEASfQiHkSLEEC9DvPsGRAEUfDTVgEh/koIpKdPGnODT7xT/DkhsJgKkjbc4ImaZmJgoBYa40YbWcdJ/4paM/vTHh1dG7mNR+4odbH5XKD14skBwJhzLXrNbf98YOCVMWZZ5HdlMrBSNFqT/WqPje1uBlqiifmrZn/a96HTz+wJm3l/HGwRyD98OOwq9VPka2NQqdXgp7guJvoa72ZHLOlkhv8XCvdqYVhoxiQRHKUgiRpNyMwwzKyUutB59+7hdsILTrSpwcFvQq2PBlqvAFFdCjEDZgYRGWM6mdmSUlYsovPd9++fX6iyt8KqOd64bqh3AAAAAElFTkSuQmCC";var f,E,w,B,p,I,T;class Y{constructor(i,t){A(this,I);A(this,f,12);A(this,E,2);A(this,w,0);A(this,B,2);A(this,p,24);this.SIZE_MILTIPLIER=t;const{ctx:r,width:e,height:s}=new i(this.SIZE_MILTIPLIER);this.ctx=r,this.ctxWidth=e,this.ctxHeight=s,this.interactiveElementMap=[],this.interactiveImageList=[],this.globalInteractiveList=[],this.addInteractiveElementImage()}addInteractiveElementImage(){[K,U].forEach(i=>{const t=new Image;t.src=i,this.interactiveImageList.push(t)})}addPlayableHero(i){this.hero=new i(this.ctx,this.ctxWidth,this.ctxHeight,this.SIZE_MILTIPLIER)}addSimpleInteractiveItem(i){this.interactiveElementMap.push(i)}collision(){this.collisionWithInteractiveElement()}collisionWithInteractiveElement(){const i=this.globalInteractiveList.findIndex(({positionX:s,positionY:h})=>this.hero.bodyPositionList.at(-1).x===s&&this.hero.bodyPositionList.at(-1).y===h);i!==-1&&(this.globalInteractiveList.splice(i,1),this.hero.grow(),m(this,I,T).call(this,!0));const t=this.hero.bodyPositionList.slice(0,this.hero.bodyPositionList.length-1),r=this.hero.bodyPositionList.at(-1);t.some(({x:s,y:h})=>s===r.x&&h===r.y)&&(this.hero.degradate(),m(this,I,T).call(this,!1))}interactive(){if(this.globalInteractiveList.length<a(this,E))for(let i=0;i<a(this,f);++i)this.globalInteractiveList.push(new this.interactiveElementMap[0](this.ctx,this.ctxWidth,this.ctxHeight,this.SIZE_MILTIPLIER,Math.round(Math.random()*2+1)%2===0?this.interactiveImageList[0]:this.interactiveImageList[1],a(this,p)));this.globalInteractiveList.forEach(i=>{i.draw()})}draw(){this.ctx.clearRect(0,0,this.ctxWidth,this.ctxHeight),this.interactive(),this.hero&&this.hero.draw(),this.collision()}}f=new WeakMap,E=new WeakMap,w=new WeakMap,B=new WeakMap,p=new WeakMap,I=new WeakSet,T=function(i){i?l(this,w,a(this,w)+a(this,B)):l(this,w,0),document.querySelector(".js_score").textContent=a(this,w)};const G=20,F=8;let v=0,k=F;const x=new Y(O,G);x.addPlayableHero(H);x.addSimpleInteractiveItem(V);function N(){v++,v%k===0&&x.draw(),requestAnimationFrame(N)}N();window.addEventListener("keydown",o=>{if(o.code==="Space"){k=2;return}x.hero.setDirection(o.code)});window.addEventListener("keyup",o=>{o.code==="Space"&&(k=F)});
