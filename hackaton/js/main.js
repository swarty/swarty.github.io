'use strict';$('.holder').fadeIn(),document.addEventListener('DOMContentLoaded',function(){function d(){y.addEventListener('click',function(E){for(var F=E.target.getAttribute('data-color'),G=Array.from(x,function(J){return J.querySelectorAll('td')[2]}),H=0;H<C.length;H++)C[z]=F;D.chart.destroy(),j();var I=document.querySelectorAll('td[data-index]');I[z].style.backgroundColor=F,$(y).fadeOut(),z=null})}function f(E){$(y).fadeIn(),z=E.target.getAttribute('data-index')}function i(){w=document.querySelectorAll('td'),x=document.querySelectorAll('tr');var E=w.length,F=Array.from(x,function(H){return H.querySelectorAll('td')[0].textContent}),G=Array.from(x,function(H){return H.querySelectorAll('td')[1].textContent});return arrTable=[F.slice(1,F.length),G.slice(1,G.length)]}function j(){D.chart=new Chart(u,{type:D.chartType,data:{labels:D.x_axis,datasets:[{label:'\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u043B\u0435\u0433\u0435\u043D\u0434\u044B',data:D.y_axis,backgroundColor:D.bg_color,borderColor:['#880','#880','#880','#880','#880','#880'],borderWidth:1,fill:!1,pointRadius:10,pointHoverRadius:15}]},options:{responsive:!0,title:{display:!0,text:D.chartName},elements:{point:{pointStyle:'circle'}},legend:{display:!1,fullWidth:!0,position:'top',labels:{fontColor:'black',fontSize:20}},scales:{yAxes:[{ticks:{beginAtZero:!0}}]},tooltips:{}}})}function m(){function E(){F[0].setAttribute('contenteditable','false'),F[1].setAttribute('contenteditable','false'),F[2].setAttribute('contenteditable','false')}var F=document.querySelectorAll('td');F.forEach(function(G){G.setAttribute('contenteditable','true')}),F[2].querySelector('span')&&F[0].querySelector('span')&&F[1].querySelector('span')?(E(),F[0].querySelector('span').setAttribute('contenteditable','false'),F[1].querySelector('span').setAttribute('contenteditable','false'),F[2].querySelector('span').setAttribute('contenteditable','false')):E()}function n(){w.forEach(function(E){E.addEventListener('click',function(F){F.target.addEventListener('blur',q)})})}function o(){var E=document.querySelectorAll('table');E[0].innerHTML=' '}function q(){i(),D.chart.data.labels=arrTable[0],D.chart.data.datasets[0].data=arrTable[1],D.chart.update({duration:800,easing:'easeOutBounce'})}$('.holder').fadeOut();var u=document.getElementById('myChart'),v=document.querySelector('.btn-type-wrp'),w=null,x=null;(function(){function E(M,N,O){F.insertAdjacentHTML('beforeend','<div class="active-color" data-color="'+M+'" style="background-color: '+M+'"></div>'),G.insertAdjacentHTML('beforeend','<div class="active-color" data-color="'+N+'" style="background-color: '+N+'"></div>'),H.insertAdjacentHTML('beforeend','<div class="active-color" data-color="'+O+'" style="background-color: '+O+'"></div>')}var F=document.querySelector('.first'),G=document.querySelector('.next'),H=document.querySelector('.end'),I=['#ed1c24','#fff200','#00a651','#00aeef','#9e1f63','#ec008c','#be1e2d','#ef4136'],J=['#f15a29','#f7941d','#fbb040','#d7df23','#8dc63f','#39b54a','#009444','#006838'],K=['#2bb673','#00a79d','#27aae1','#1b75bc','#2b3990','#262262','#662d91','#92278f'];for(var L=0;8>L;L++)E(I[L],J[L],K[L])})();var y=document.querySelector('.blockColors'),z=null;i(),function(){x.forEach(function(G){G.insertAdjacentHTML('beforeend','<td class="paint"></td>')});var F=Array.from(x,function(G){return G.querySelectorAll('td')[2]});F[0].textContent='\u0412\u0430\u0448 \u0446\u0432\u0435\u0442'}(),function(E){var F=Array.from(x,function(G){return G.querySelectorAll('td')[2]});F.forEach(function(G,H){0!==H&&(G.setAttribute('data-paint',E),G.setAttribute('data-index',H-1),G.addEventListener('click',f))}),d()}();var A=arrTable[1],B=arrTable[0],C=['hsl(81, 94%, 50%)','hsl(162, 95%, 50%)','hsl(141, 91%, 50%)','hsl(164, 92%, 50%)','hsl(219, 94%, 50%)','hsl(260, 95%, 50%)','hsl(11, 93%, 50%)','hsl(238, 94%, 50%)','hsl(289, 94%, 50%)','hsl(78, 92%, 50%)'],D={chart:{},chartType:'bar',chartName:'My Chart',x_axis:B,y_axis:arrTable[1],bg_color:C,bg_cache:null};v.addEventListener('click',function(E){E.preventDefault(),document.querySelectorAll('.s_menu__button').forEach(function(G){G.classList.remove('s_menu__button--active')}),E.path[0].classList.add('s_menu__button--active');var F=!('line'!==E.target.dataset.type);F?(D.bg_cache=D.bg_color,D.bg_color='#808'):D.bg_cache?D.bg_color=D.bg_cache:D.bg_cache=D.bg_color,D.chartType=E.target.getAttribute('data-type'),D.chart.destroy(),j(),q()},!1),function(){var F=document.querySelector('.s_downloadPdf'),G=document.getElementById('myChart'),H=G.getContext('2d'),I=document.getElementById('img-from-canvas');F.addEventListener('click',function(){var J=G.toDataURL('image/png',1);I.setAttribute('src',J);var K=new jsPDF('p','mm','a4');K.addImage(J,'PNG',10,10,200,180),K.save('my-chart.pdf')})}(),function(){var E=document.querySelector('.s_downloadPng');E.addEventListener('click',function(){var G=document.querySelector('.myChart').toDataURL('image/png');E.href=G})}(),function(){var E=document.querySelector('tbody');document.querySelector('.s_new-row').addEventListener('click',function(){E.innerHTML+='<tr>\n                <td></td>\n                <td></td>\n            </tr>',m()})}(),m(),j(),function(){function F(I){H.innerHTML=XLSX.utils.sheet_to_html(I.Sheets[I.SheetNames[0]],{editable:!0}).replace('<table','<table id="table" border="1"')}var G=document.getElementById('loadExcel'),H=document.getElementById('outfile');G.addEventListener('change',function(I){var J=new FileReader;J.readAsArrayBuffer(I.target.files[0]);var K=document.querySelector('.s_docName');K.innerHTML+='<span> File name: '+I.target.files[0].name+' </span>';var L=document.querySelector('.img_download');L.addEventListener('click',function(){J=''}),$('.holder').fadeIn(),J.addEventListener('loadend',function(){var M=new Uint8Array(J.result),N=XLSX.read(M,{type:'array'});o(),F(N),m(),$('.holder').fadeOut(),q(),n()})},!1)}(),function(){var E=document.querySelector('.s_table__button');E.addEventListener('click',function(){i(),D.chart.data.labels=arrTable[0],D.chart.data.datasets[0].data=arrTable[1],D.chart.options.title.text=document.querySelector('.s_table__input').value,D.chart.update({duration:800,easing:'easeOutBounce'})})}(),n()});